CREATE OR REPLACE PROCEDURE INSERT_LOGIC(CHARACTER VARYING(50), CHARACTER VARYING(50))
RETURNS BOOLEAN EXECUTE AS CALLER
LANGUAGE NZPLSQL AS
BEGIN_PROC
 DECLARE num_args int4; sql CHARACTER VARYING(2000); sql1 char(100); col_name1 CHARACTER VARYING(500);
 t2 ALIAS FOR $1;
 t3 ALIAS FOR $2;
 BEGIN num_args := PROC_ARGUMENT_TYPES.count;
 RAISE NOTICE 'Number of arguments: %', num_args;
 sql1:='TRUNCATE TABLE ' || t3 || '';
 col_name1:=PASS_VAR(t2);
 sql := 'INSERT INTO ' || t3 || '('|| col_name1 ||') SELECT DISTINCT ' || col_name1 ||' FROM ' || t2 ||'';
 RAISE NOTICE 'SQL Statement: %', sql;
 EXECUTE IMMEDIATE sql1;
 EXECUTE IMMEDIATE sql;
 END;
END_PROC;